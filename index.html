<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Embedded Chatbot template</title>
  </head>
  <body>
    <!-- <p>
      Provide a snippet of HTML code and doc for website owners to embed the
      chatbot. This code should include:
    </p>
    <ul>
      <li>An iframe tag with the source (src) set to your public URL.</li>
      <li>
        Attributes to define the size and styling of the iframe (optional).
      </li>
      <li>
        Configure CORS settings on your server to control which domains can
        embed your chatbot.
      </li>
      <li>
        Each user must have their own unique key to access the chatbot.
      </li>
    </ul> -->
    <div
      style="
        position: fixed;
        background: transparent;
        z-index: 999999999;
        transition: transform 0.3s;
        transform: translateY(0px);
        opacity: 1;
        box-shadow: rgba(0, 0, 0, 0.16) 0px 5px 40px;
        border-radius: 8px 8px 0px 0px;
        cursor: pointer;
        bottom: 8px;
        overflow: hidden;
        width: 104px;
        height: 41px;
        right: 8px;
        border-radius: 16px;
      "
      id="widget-container"
    >
      <iframe
        title="ai-chatbot"
        id="chatbot-widget"
        style="border-radius: 8px"
        width="100%"
        height="100%"
        src="http://localhost:3000/chat"
        frameborder="0"
      ></iframe>
    </div>
  </body>
  <script>
    const CHAT_WIDTH = 380;
    const CHAT_HEIGHT = 650;
    const BUTTON_WIDTH = 104;
    const BUTTON_HEIGHT = 41;

    const chatWidgetContainer = document.getElementById("widget-container");

    window.onmessage = (event) => {
      if (event.data.type === "UPDATE_POPUP_STATE") {
        if (event.data.isOpen) {
          chatWidgetContainer.style.width = `${CHAT_WIDTH}px`;
          chatWidgetContainer.style.height = `${CHAT_HEIGHT}px`;
          chatWidgetContainer.style.bottom = "-72px";
          chatWidgetContainer.style.opacity = "0";
          chatWidgetContainer.style.transition = "transform 0.3s";
          chatWidgetContainer.style.transform = `translateY(-80px)`;
          // setTimeout(() => {
          //   chatWidgetContainer.style.transition = "transform 0.3s";
          // });
          setTimeout(() => {
            chatWidgetContainer.style.transition =
              "transform 0.3s, opacity 0.3s";
            chatWidgetContainer.style.opacity = "1";
          }, 300);
          // setTimeout(() => {
          //   chatWidgetContainer.style.transition =
          //     "transform 0.3s, opacity 0.3s";
          //   chatWidgetContainer.style.opacity = "1";
          // }, 300);
        } else {
          chatWidgetContainer.style.transform = `translateY(0px)`;
          chatWidgetContainer.style.opacity = "0";
          setTimeout(() => {
            chatWidgetContainer.style.bottom = "8px";
            chatWidgetContainer.style.width = `${BUTTON_WIDTH}px`;
            chatWidgetContainer.style.height = `${BUTTON_HEIGHT}px`;
            chatWidgetContainer.style.opacity = "1";
            chatWidgetContainer.style.transition = "transform 0.3s";
          }, 300);
        }
      }
    };
  </script>
</html>
